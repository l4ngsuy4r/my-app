(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{14:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),r=n(6),o=n.n(r),c=(n(14),n(4)),l=n(1),p=n(8),f=n(2);n(17);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s=function(e){var t=e.file,n=e.onFileUpdate;return t?a.a.createElement("div",{className:"container"},a.a.createElement("input",{placeholder:"Title",type:"text",value:t.title,onChange:function(e){return n(d({},t,{title:e.target.value}))}}),a.a.createElement("textarea",{placeholder:"Whats on your mind?",value:t.body,onChange:function(e){return n(d({},t,{body:e.target.value}))}})):a.a.createElement("div",null,"Select a file")},y=(n(18),function(e){var t=e.itemList,n=e.itemMap,r=e.activeItemId,o=e.onItemClick,c=Object(i.useMemo)((function(){return t.sort((function(e,t){return e>t?-1:e<t?1:0}))}),[t]).map((function(e){return a.a.createElement("li",{key:e,onClick:function(){return o(e)},className:e===r?"active":""},n[e]?n[e].title:"")}));return a.a.createElement("ul",null,c)});function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I="https://re-back.herokuapp.com/files",b={Accept:"application/json","Content-Type":"application/json"},v={},m=function(){var e=Object(f.b)((function(e,t){var n=t.type,i=t.payload;switch(n){case"LOAD_SUCCESS":return E({},e,{fileList:i.fileList,fileMap:i.fileMap});case"SET_ACTIVE":return E({},e,{activeFileId:i.fileId});case"OPTIMISTIC_CREATE":var a=i.fileToCreate;return E({},e,{fileList:[a._id].concat(Object(c.a)(e.fileList)),fileMap:E({},e.fileMap,Object(l.a)({},a._id,a)),activeFileId:a._id});case"CREATE_FAIL":var r=i.fileId;return E({},e,{fileList:e.fileList.filter((function(e){return e!==r})),fileMap:E({},e.fileMap,Object(l.a)({},r,void 0))});case"OPTIMISTIC_UPDATE":var o=i.fileToUpdate,p=i.oldValue,f=e.pendingUpdateMap[o._id];return E({},e,{fileMap:E({},e.fileMap,Object(l.a)({},o._id,o)),pendingUpdateMap:E({},e.pendingUpdateMap,Object(l.a)({},o._id,f||p))});case"UPDATE_SUCCESS":var u=i.fileId;return E({},e,{pendingUpdateMap:E({},e.pendingUpdateMap,Object(l.a)({},u,void 0))});case"UPDATE_FAIL":var d=i.fileId;return E({},e,{fileMap:E({},e.fileMap,Object(l.a)({},d,e.pendingUpdateMap[d])),pendingUpdateMap:E({},e.pendingUpdateMap,Object(l.a)({},d,void 0))});case"OPTIMISTIC_DELETE":var s=i.fileId,y=i.oldValue;return E({},e,{activeFileId:e.activeFileId===s?void 0:e.activeFileId,fileList:e.fileList.filter((function(e){return e!==s})),fileMap:E({},e.fileMap,Object(l.a)({},s,void 0)),pendingDeleteMap:E({},e.pendingDeleteMap,Object(l.a)({},s,y))});case"DELETE_FAIL":var O=i.fileId;return E({},e,{fileList:[].concat(Object(c.a)(e.fileList),[O]),fileMap:E({},e.fileMap,Object(l.a)({},O,e.pendingDeleteMap[O])),pendingDeleteMap:E({},e.pendingDeleteMap,Object(l.a)({},O,void 0))});default:return e}}),{fileList:[],fileMap:{},pendingUpdateMap:{},pendingDeleteMap:{}},"APP"),t=Object(p.a)(e,2),n=t[0],r=t[1],o=Object(i.useMemo)((function(){return n.fileMap[n.activeFileId]}),[n.fileMap,n.activeFileId]);Object(i.useMemo)((function(){if(!n.activeFileId){var e=n.fileList.sort((function(e,t){return e>t?-1:e<t?1:0}))[0];r({type:"SET_ACTIVE",payload:{fileId:e}})}}),[n.activeFileId,n.fileList]),Object(i.useEffect)((function(){fetch(I).then((function(e){return e.json()})).then((function(e){return r({type:"LOAD_SUCCESS",payload:{fileList:e.map((function(e){return e._id})),fileMap:e.reduce((function(e,t){return e[t._id]=t,e}),{})}})}))}),[]);return a.a.createElement(a.a.Fragment,null,a.a.createElement("button",{onClick:function(){var e=Date.now(),t={_id:e,title:"",body:""};r({type:"OPTIMISTIC_CREATE",payload:{fileToCreate:t}}),fetch(I,{method:"POST",body:JSON.stringify(t),headers:b}).then((function(e){return e.json()})).then((function(){}),(function(){return r({type:"CREATE_FAIL",payload:{fileId:e}})}))}},"Create"),a.a.createElement("button",{onClick:function(){var e=n.activeFileId,t=E({},n.fileMap[e]);r({type:"OPTIMISTIC_DELETE",payload:{fileId:e,oldValue:t}}),fetch(I,{method:"DELETE",body:JSON.stringify({_id:e}),headers:b}).then((function(){return r({type:"DELETE_SUCCESS",payload:{fileId:e}})}),(function(){return r({type:"DELETE_FAIL",payload:{fileId:e}})}))}},"Delete"),a.a.createElement(y,{itemList:n.fileList,itemMap:n.fileMap,activeItemId:n.activeFileId,onItemClick:function(e){return r({type:"SET_ACTIVE",payload:{fileId:e}})}}),a.a.createElement(s,{file:o,onFileUpdate:function(e){v[e._id]&&clearTimeout(v[e._id]),r({type:"OPTIMISTIC_UPDATE",payload:{fileToUpdate:e,oldValue:E({},n.fileMap[e._id])}}),v[e._id]=setTimeout((function(){fetch(I,{method:"PUT",body:JSON.stringify(e),headers:b}).then((function(){return r({type:"UPDATE_SUCCESS",payload:{fileId:e._id}})}),(function(){return r({type:"UPDATE_FAIL",payload:{fileId:e._id}})}))}),2e3)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(f.a,{name:"App"},a.a.createElement(m,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},9:function(e,t,n){e.exports=n(19)}},[[9,1,2]]]);
//# sourceMappingURL=main.37868d31.chunk.js.map